create TABLE IF NOT EXISTS users
(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    email VARCHAR (512) NOT NULL,
    name VARCHAR (512) NOT NULL,
    CONSTRAINT pk_user PRIMARY KEY (id),
    CONSTRAINT UQ_USER_EMAIL UNIQUE (email));

create TABLE IF NOT EXISTS item_requests
(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    description VARCHAR (1024) NOT NULL,
    requester_id BIGINT not null,
    created TIMESTAMP  not null,
    CONSTRAINT pk_item_request PRIMARY KEY (id),
    CONSTRAINT FK_ITEM_REQUEST_REQUESTER FOREIGN KEY (requester_id) REFERENCES users (id));

create TABLE IF NOT EXISTS items
(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    description VARCHAR (1024) NOT NULL,
    name VARCHAR(512) NOT NULL,
    available BOOLEAN DEFAULT TRUE,
    owner_id BIGINT,
    request_id BIGINT,
    CONSTRAINT pk_item PRIMARY KEY (id),
    CONSTRAINT FK_ITEM_REQUEST FOREIGN KEY (request_id) REFERENCES item_requests(id),
    CONSTRAINT FK_ITEM_OWNER FOREIGN KEY (owner_id) REFERENCES users (id));

create TABLE IF NOT EXISTS bookings
(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    booking_start TIMESTAMP NOT NULL,
    booking_end TIMESTAMP NOT NULL,
    booking_status VARCHAR(512) NOT NULL,
    booker_id BIGINT,
    item_id BIGINT,
    CONSTRAINT pk_booking PRIMARY KEY(id),
    CONSTRAINT FK_BOOKING_OWNER FOREIGN KEY(booker_id) REFERENCES users(id),
    CONSTRAINT FK_BOOKING_ITEM FOREIGN KEY(item_id) REFERENCES items (id));

create TABLE IF NOT EXISTS comments
(
    id BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    text VARCHAR (1024) NOT NULL,
    item BIGINT,
    author BIGINT,
    created TIMESTAMP NOT NULL,
    CONSTRAINT pk_comment PRIMARY KEY(id),
    CONSTRAINT FK_COMMENT_OWNER FOREIGN KEY(author) REFERENCES users(id),
    CONSTRAINT FK_COMMENT_ITEM FOREIGN KEY(item) REFERENCES items (id));